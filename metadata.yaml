name: aad-revoke-session
description: Revoke all Azure AD sign-in sessions for a user

# Input parameters for web form generation
inputs:
  userPrincipalName:
    type: text
    description: The user principal name (UPN) of the user whose sessions should be revoked
    required: true
    validation:
      min: 1
      max: 255

# Secrets required from context
secrets:
  AZURE_AD_TOKEN:
    description: Azure AD access token with User.ReadWrite.All permission
    required: true

# Environment variables
environment:
  AZURE_AD_TENANT_URL:
    description: Azure AD tenant URL (e.g., https://graph.microsoft.com/v1.0)
    default: https://graph.microsoft.com/v1.0

# Expected output structure
outputs:
  status:
    type: text
    description: Operation result (success, failed, recovered, etc.)

  userPrincipalName:
    type: text
    description: The user principal name whose sessions were revoked

  value:
    type: boolean
    description: True if the revocation was successful